# Pupervisor

Легковесный менеджер процессов с веб-интерфейсом, написанный на Go.

## Описание

Pupervisor - это аналог supervisor для управления процессами с современным веб-интерфейсом. Позволяет запускать, останавливать, перезапускать процессы и просматривать их логи в реальном времени. Все статические файлы встроены в бинарник - для работы нужен только один исполняемый файл.

## Возможности

- **Dashboard** - обзор состояния системы с графиками (распределение статусов, активность за последний час)
- **Управление процессами** - запуск, остановка, перезапуск с просмотром stdout/stderr
- **Поиск и фильтрация** - быстрый поиск процессов по имени и фильтрация по статусу
- **Логи** - просмотр системных и worker логов с фильтрацией по уровню
- **Настройки** - конфигурация через веб-интерфейс
- **Без внешних зависимостей** - кастомные CSS и JS, без CDN

## Требования

- Go 1.21 или выше

## Установка и запуск

```bash
# Клонирование репозитория
git clone https://github.com/zhandos717/gopervisor
cd pupervisor

# Установка зависимостей
go mod tidy

# Запуск
go run cmd/server/main.go
```

Откройте браузер: http://localhost:8080

### Сборка бинарника

```bash
go build -o pupervisor cmd/server/main.go
./pupervisor
```

## Структура проекта

```
pupervisor/
├── cmd/
│   └── server/
│       └── main.go                 # Точка входа
├── internal/
│   ├── api/
│   │   └── router.go               # HTTP маршрутизация
│   ├── config/
│   │   ├── config.go               # Конфигурация приложения
│   │   └── process_config.go       # Конфигурация процессов
│   ├── handlers/
│   │   ├── health_handler.go       # Health check endpoint
│   │   ├── process_handler.go      # API для управления процессами
│   │   └── template_handler.go     # Рендеринг HTML страниц
│   ├── middleware/
│   │   └── logging.go              # Логирование запросов
│   ├── models/
│   │   └── process.go              # Модели данных
│   └── service/
│       └── process_manager.go      # Бизнес-логика управления процессами
├── web/
│   ├── css/
│   │   └── style.css               # Стили (кастомные, без CDN)
│   ├── js/
│   │   ├── api.js                  # API клиент
│   │   ├── display.js              # Функции отображения
│   │   ├── main.js                 # Инициализация
│   │   └── process-actions.js      # Действия с процессами
│   ├── templates/
│   │   ├── dashboard.html          # Главная страница с графиками
│   │   ├── processes.html          # Управление процессами
│   │   ├── logs.html               # Просмотр логов
│   │   └── settings.html           # Настройки
│   ├── embed.go                    # Встраивание статики в бинарник
│   └── index.html                  # Базовый шаблон
├── go.mod
├── go.sum
└── README.md
```

## API

### Процессы

| Метод | Endpoint | Описание |
|-------|----------|----------|
| GET | `/api/processes` | Список всех процессов |
| GET | `/api/processes/{name}` | Информация о процессе |
| POST | `/api/processes/{name}/start` | Запустить процесс |
| POST | `/api/processes/{name}/stop` | Остановить процесс |
| POST | `/api/processes/{name}/restart` | Перезапустить процесс |
| GET | `/api/processes/{name}/output` | Stdout/stderr процесса |

### Логи

| Метод | Endpoint | Описание |
|-------|----------|----------|
| GET | `/api/logs` | Все логи |
| GET | `/api/logs/worker` | Worker логи |
| GET | `/api/logs/system` | Системные логи |

### Система

| Метод | Endpoint | Описание |
|-------|----------|----------|
| GET | `/api/health` | Health check |
| GET | `/api/settings` | Текущие настройки |
| POST | `/api/settings` | Обновить настройки |

## Веб-интерфейс

### Dashboard
- Статистика: общее количество процессов, запущенные, остановленные
- Donut-график распределения статусов
- Line-график активности за последний час
- Список последних событий

### Processes
- Таблица всех процессов с действиями
- Поиск по имени
- Фильтрация по статусу (Running/Stopped)
- Просмотр stdout/stderr в модальном окне

### Logs
- Worker логи с фильтрацией по уровню (Info/Warning/Error)
- Системные логи
- Объединенный просмотр всех логов
- Автообновление каждые 10 секунд

### Settings
- Конфигурация автозапуска
- Интервал проверки состояния
- Лимиты ресурсов

## Лицензия

MIT
